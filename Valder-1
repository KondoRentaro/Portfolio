＃シーケンス保存スコア関数、Valdar 2001から-https：//doi.org/10.1002/1097-0134 \（20010101 \）42：1 <108 :: AID-PROT110> 3.0.CO; 2-O

 パンダ を pdとしてインポートします
 numpy を npとしてインポートします

＃負荷置換マトリックス（PET91）
＃https：//doi.org/10.1093/bioinformatics/8.3.275
pet91  =  pd。read_csv（'pet91.csv'、コメント= '！'、index_col = 0）
m  =  pet91

＃最小値と最大値を取得する
m_min  =  np。min（m .stack（）。values）
m_max  =  np。max（m .stack（）。values）

＃アミノ酸類似度関数を定義する
def  Mut（a、b）：
     a  ==  '-' または b  ==  '-'の場合：
         0を返す
    
    return（m [ a ] [ b ] --m_min）/（m_max --m_min ）_   

＃シーケンス間の進化距離の関数を定義する
def  Dist（s_j、s_k）：
     len（s_j）==  len（s_k）をアサートします
    
    ＃まだの場合は、文字列をリストに変換します
    s_j  = リスト（s_j）
    s_k  = リスト（s_k）
    
    ＃位置合わせされた位置にフラグを立てる（ギャップなし）
    non_gap_positions  = []
     範囲内のi の 場合（0、len（s_j））：
        if  s_j [ i ] ==  '-' または s_k [ i ] ==  '-'：
            継続する
        non_gap_positions。追加（i）
    
    ＃ギャップ以外の位置の数を数える
    n_aligned_jk  =  len（non_gap_positions）
    
    ＃ギャップのない位置ごとに、計算して合計します。
    ＃2つのアミノ酸間の類似性
    sum_similarity  =  0。
     non_gap_positionsのi の 場合：
        sum_similarity  =  sum_similarity  +  Mut（s_j [ i ]、s_k [ i ]）
    
    戻り 値1-  （ sum_similarity / n_aligned_jk）  

＃シーケンス重み関数を定義する
def ウェイト（s_j、all_sequences）：
     all_sequences で s_jをアサートします
    
    sum_distances  =  0。
     all_sequences のs_kの 場合：
        ＃同等性を比較するために文字列にキャストする必要があります
         ''の場合。join（s_j）==  ''。参加（s_k）：
            継続する
        sum_distances  =  sum_distances  +  Dist（s_j、s_k）
    
    戻り 値sum_distances  /（len（all_sequences）-1  ）

#Weight（sequence_mat [10]、sequence_mat）

＃保存機能を定義する
＃シーケンス内の各位置の保存スコアを含むベクトルを返します
def  Cons（all_sequences）：
    
    sequence_length  =  len（all_sequences [ 0 ]）
    sum_numerator  = [ 0.、] *  sequence_length
    sum_denominator  =  0。
    
     範囲内のj の 場合（0、len（all_sequences））：
        s_j  =  all_sequences [ j ]
        W_j  = 重み（s_j、all_sequences）
         範囲内のk の 場合（j + 1、len（all_sequences））：  
            s_k  =  all_sequences [ k ]
            W_k  = 重み（s_k、all_sequences）
            
            ＃AAポジションごと
             範囲（0、sequence_length ）のi の 場合：
                sum_numerator [ i ] =  sum_numerator [ i ] +（W_j  *  W_k  *  Mut（s_j [ i ]、s_k [ i ]））
                
            sum_denominator  =  sum_denominator  +（W_j  *  W_k）
            
    結果 =  sum_numerator
    結果 = [ x  / 結果のxのsum_denominator  ]   
    
     結果を返す

＃ 例：
sequence_mat  = [
リスト（'GADGVGNASGNWHCDSTWLGDRVITTSTRTWALPTYNNHLYKQISSAST-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTTNDGVTTIANNLTSTVQVFSDSEYQLPYVLGSAHQGCLPPFPADVFMIPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEEVPFHSSYAHSQSLDRLMNPLIDQYLYYLNRTQN-QSGSAQNKDLLFSRGSPAGMSVQPKNWLPGPCYRQQRVSKTKTDNNNSN ----- FTWTGASKYNLNGRESIINPGTAMASHKDDEDKFFPMSGVMIFGKESAGA --- SNTALDNVMITDEEEIKATNPVATERFGTVAVNFQSSSTDPATGDVHAMGALPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKNPPPQILIKNTPVPANPPAEFSATKFASFITQYSTGQVSVEIEWELQKENSKRWNPEVQYTSNYAKSANVDFTVDNNGLYTEPRPIGTRYLTRPL' ）、
リスト（ '--DGVGNSSGNWHCDSTWMGDRVITTSTRTWALPTYNNHLYKQISSQ-S-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTQNDGTTTIANNLTSTVQVFTDSEYQLPYVLGSAHQGCLPPFPADVFMVPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLSRTN-TPSGTTTQSRLQFSQAGASDIRDQSRNWLPGPCYRQQRVSKTSADNNNSE ----- YSWTGATKYHLNGRDSLVNPGPAMASHKDDEEKFFPQSGVLIFGKQGSEK --- TNVDIEKVMITDEEEIRTTNPVATEQYGSVSTNLQRGNRQAATADVNTQGVLPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQILIKNTPVPANPSTTFSAAKFASFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYNKSVNVDFTVDTNGVYSEPRPIGTRYLTRNL'）、
リスト（ 'GADGVGNSSGNWHCDSTWMGDRVITTSTRTWALPTYNNHLYKQISSQ-S-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTQNDGTTTIANNLTSTVQVFTDSEYQLPYVLGSAHQGCLPPFPADVFMVPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLSRTN-TPSGTTTQSRLQFSQAGASDIRDQSRNWLPGPCYRQQRVSKTSADNNNSE ----- YSWTGATKYHLNGRDSLVNPGPAMASHKDDEEKFFPQSGVLIFGKQGSEK --- TNVDIEKVMITDEEEIRTTNPVATEQYGSVSTNLQRGNRQAATADVNTQGVLPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQILIKNTPVPANPSTTFSAAKFASFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYNKSVNVDFTVDTNGVYSEPRPIGTRYLTRNL'）、
リスト（'GADGVGNSSGNWHCDSQWLGDRVITTSTRTWALPTYNNHLYKQISSQ-S-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKKLSFKLFNIQVKEVTQNDGTTTIANNLTSTVQVFTDSEYQLPYVLGSAHQGCLPPFPADVFMVPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFQFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLNRTQGTTSGTTNQSRLLFSQAGPQSMSLQARNWLPGPCYRQQRLSKTANDNNNSN ----- FPWTAASKYHLNGRDSLVNPGPAMASHKDDEEKFFPMHGNLIFGKEGTTA --- SNAELDNVMITDEEEIRTTNPVATEQYGTVANNLQSSNTAPTTRTVNDQGALPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQIMIKNTPVPANPPTTFSPAKFASFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYNKSVNVDFTVDTNGVYSEPRPIGTRYLTRNL' ）、
リスト（'GADGVGNASGDWHCDSTWSEGHVTTTSTRTWVLPTYNNHLYKRLG ----- ESLQSNTYNGFSTPWGYFDFNRFHCHFSPRDWQRLINNNWGMRPKAMRVKIFNIQVKEVTTSNGETTVANNLTSTVQIFADSSYELPYVMDAGQEGSLPPFPNDVFMVPQYGYCGLVTGNTSQQQTDRNAFYCLEYFPSQMLRTGNNFEITYSFEKVPFHSMYAHSQSLDRLMNPLIDQYLWGLQSTTTGTTLNAGTATTNFTKLRPTNFSNFKKNWLPGPSIKQQGFSKTANQNYKIPATGSDSLIKYETHSTLDGRWSALTPGPPMATAGPADSKFS-NSQLIFAGPKQNGN --- TATVPGTLIFTSEEELAATNATDTDMWGNLPGGDQSNSNLPTVDRLTALGAVPGMVWQNRDIYYQGPIWAKIPHTDGHFHPSPLIGGFGLKHPPPQIFIKNTPVPANPATTFSSTPVNSFITQYSTGQVSVQIDWEIQKERSKRWNPEVQFTSNYGQQNSLLWAPDAAGKYTEPRAIGTRYLTHHL' ）、
リスト（ '--DGVGNASGDWHCDSTWMGDRVVTKSTRTWVLPSYNNHQYREIKSGSV-DGSNANAYFGYSTPWGYFDFNRFHSHWSPRDWQRLINNYWGFRPRSLRVKIFNIQVKEVTVQDSTTTIANNLTSTVQVFTDDDYQLPYVVGNGTEGCLPAFPPQVFTLPQYGYATLNRDNT-ENPTERSSFFCLEYFPSKMLRTGNNFEFTYNFEEVPFHSSFAPSQNLFKLANPLVDQYLYRFVSTNNT ------- GGVQFNKNLAGRYANTYKNWFPGPMGRTQGWNLGSGVNRASV ----- SAFATTNRMELEGASYQVPPQPNGMTNNLQGSNTYALENTMIFNSQPANPGTTATYLEGNMLITSESETQPVNRVAYNVGGQMATNNQSSTTAPATGTYNLQEIVPGSVWMERDVYLQGPIWAKIPETGAHFHPSPAMGGFGLKHPPPMMLIKNTPVPGNI-TSFSDVPVSSFITQYSTGQVTVEMEWELKKENSKRWNPEIQYTNNYNDPQFVDFAPDSTGEYRTTRPIGTRYLTRPL'）、
リスト（'-ADGVGNASGNWHCDSTWLGDRVITTSTRTWALPTYNNHLYKQISSAST-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTTNDGVTTIANNLTSTVQVFSDSEYQLPYVLGSAHQGCLPPFPADVFMIPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLNRTQN-QSGSAQNKDLLFSRGSPAGMSVQPKNWLPGPCYRQQRVSKTKTDNNNSN ----- FTWTGASKYNLNGRESIINPGTAMASHKDDKDKFFPMSGVMIFGKESAGA --- SNTALDNVMITDEEEIKATNPVATERFGTVAVNLQSSSTDPATGDVHVMGALPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQILIKNTPVPANPPAEFSATKFASFITQYSTGQVSVEIEWELQKENSKRWNPEVQYTSNYAKSANVDFTVDNNGLYTEPRPIGTRYLTRPL' ）、
リスト（'GADGVGNASGNWHCDSTWLGDRVITTSTRTWALPTYNNHLYKQISSAST-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTTNDGVTTIANNLTSTVQVFSDSEYQLPYVLGSAHQGCLPPFPADVFMIPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLNRTQN-QSGSAQNKDLLFSRGSPAGMSVQPKNWLPGPCYRQQRVSKTKTDNNNSN ----- FTWTGASKYNLNGRESIINPGTAMASHKDDKDKFFPMSGVMIFGKESAGA --- SNTALDNVMITDEEEIKATNPVATERFGTVAVNLQSSSTDPATGDVHVMGALPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQILIKNTPVPANPPAEFSATKFASFITQYSTGQVSVEIEWELQKENSKRWNPEVQYTSNYAKSANVDFTVDNNGLYTEPRPIGTRYLTRPL' ）、
リスト（'--DGVGSSSGNWHCDSQWLGDRVITTSTRTWALPTYNNHLYKQISNSTSGGSSNDNAYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTDNNGVKTIANNLTSTVQVFTDSDYQLPYVLGSAHEGCLPPFPADVFMIPQYGYLTLNDG --- SQAVGRSSFYCLEYFPSQMLRTGNNFQFSYEFENVPFHSSYAHSQSLDRLMNPLIDQYLYYLSKTING - SGQNQQTLKFSVAGPSNMAVQGRNYIPGPSYRQQRVSTTVTQNNNSE ----- FAWPGASSWALNGRNSLMNPGPAMASHKEGEDRFFPLSGSLIFGKQGTGR --- DNVDADKVMITNEEEIKTTNPVATESYGQVATNHQSAQAQAQTGWVQNQGILPGMVWQDRDVYLQGPIWAKIPHTDGNFHPSPLMGGFGMKHPPPQILIKNTPVPADPPTAFNKDKLNSFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYYKSNNVEFAVNTEGVYSEPRPIGTRYLTRNL' ）、
リスト（'GADGVGNSSGNWHCDSTWLGDRVITTSTRTWALPTYNNHLYKQISNGTSGGSTNDNTYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTTNEGTKTIANNLTSTVQVFTDSEYQLPYVLGSAHQGCLPPFPADVFMVPQYGYLTLNNG --- SQALGRSSFYCLEYFPSQMLRTGNNFQFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLVRTQTT - GTGGTQTLAFSQAGPSSMANQARNWVPGPCYRQQRVSTTTNQNNNSN ----- FAWTGAAKFKLNGRDSLMNPGVAMASHKDDDDRFFPSSGVLIFGKQGAGN --- DGVDYSQVLITDEEEIKATNPVATEEYGAVAINNQAANTQAQTGLVHNQGVIPGMVWQNRDVYLQGPIWAKIPHTDGNFHPSPLMGGFGLKHPPPQILIKNTPVPADPPLTFNQAKLNSFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYYKSTNVDFAVNTEGVYSEPRPIGTRYLTRNL' ）、
リスト（'--- GVGNASGDWHCDSTWSEGKVTTTSTRTWVLPTYNNHLYLRLG ----- TTSNSNTYNGFSTPWGYFDFNRFHCHFSPRDWQRLINNNWGLRPKAMRVKIFNIQVKEVTTSNGETTVANNLTSTVQIFADSSYELPYVMDAGQEGSLPPFPNDVFMVPQYGYCGIVTGEN-QNQTDRNAFYCLEYFPSQMLRTGNNFEMAYNFEKVPFHSMYAHSQSLDRLMNPLLDQYLWHLQSTTSGETLNQGNAATTFGKIRSGDFAFYRKNWLPGPCVKQQRFSKTASQNYKIPASGGNALLKYDTHYTLNNRWSNIAPGPPMATAGPSDGDFS-NAQLIFPGPSVTGN --- TTTSANNLLFTSEEEIAATNPRDTDMFGQIADNNQNATTAPITGNVTAMGVLPGMVWQNRDIYYQGPIWAKIPHADGHFHPSPLIGGFGLKHPPPQIFIKNTPVPANPATTFTAARVDSFITQYSTGQVAVQIEWEIEKERSKRWNPEVQFTSNYGNQSSMLWAPDTTGKYTEPRVIGSRYLTNHL' ）、
リスト（ '--DGVGNSSGNWHCDSTWMGDRVITTSTRTWALPTYNNHLYKQISSQ-S-GASNDNHYFGYSTPWGYFDFNRFHCHFSPRDWQRLINNNWGFRPKRLNFKLFNIQVKEVTQNDGTTTIANNLTSTVQVFTDSEYQLPYVLGSAHQGCLPPFPADVFMVPQYGYLTLNNG --- SQAVGRSSFYCLEYFPSQMLRTGNNFTFSYTFEDVPFHSSYAHSQSLDRLMNPLIDQYLYYLSRTN-TPSGTTTQSRLQFSQAGASDIRDQSRNWLPGPCYRQQRVSKTSADNNNSE ----- YSWTGATKYHLNGRDSLVNPGPAMASHKDDEEKFFPQSGVLIFGKQGSEK --- TNVDIEKVMITDEEEIRTTNPVATEQYGSVSTNLQRGNRQAATADVNTQGVLPGMVWQDRDVYLQGPIWAKIPHTDGHFHPSPLMGGFGLKHPPPQILIKNTPVPANPSTTFSAAKFASFITQYSTGQVSVEIEWELQKENSKRWNPEIQYTSNYNKSVNVDFTVDTNGVYSEPRPIGTRYLTRNL'）
]

短所（sequence_mat）

